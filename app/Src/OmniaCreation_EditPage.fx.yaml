"OmniaCreation_EditPage As screen.'printableLayout_A4Portrait_ver1.0'":
    BackgroundImage: ='Untitled design 29'
    ImagePosition: =ImagePosition.Stretch
    Width: =1425

    oc3 As label:
        Align: =Align.Center
        Color: =RGBA(0, 18, 107, 1)
        FontWeight: =FontWeight.Bold
        Height: =67
        Size: =22
        Text: ="EDIT OMNIA CREATION FORM"
        Width: =515
        Y: =31
        ZIndex: =5

    galOCEP As gallery.galleryHorizontal:
        BorderThickness: =1
        DelayItemLoading: =true
        Items: =If(!IsBlank(tblSelectedID), LookUp(colOmniaCreation, ID=tblSelectedID))
        LoadingSpinner: =LoadingSpinner.Data
        ShowScrollbar: =false
        TemplatePadding: =3
        TemplateSize: =1383
        Width: =1390
        X: =19
        Y: =103
        ZIndex: =7

        grpOCEPFName As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =15

            txtOCEPFName As text:
                Color: =RGBA(0, 18, 107, 1)
                Default: =ThisItem.'FIRST NAME'
                OnSelect: =Select(Parent)
                Width: =268
                X: =17
                Y: =138
                ZIndex: =5

            Label5_1 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="FIRST NAME"
                Width: =320
                X: =17
                Y: =98
                ZIndex: =8

        grpOCEPMName As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =15

            txtOCEPMName As text:
                Color: =RGBA(0, 18, 107, 1)
                Default: =ThisItem.'MIDDLE NAME'
                OnSelect: =Select(Parent)
                Width: =268
                X: =17
                Y: =231
                ZIndex: =1

            Label5_2 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="MIDDLE NAME"
                Width: =320
                X: =17
                Y: =191
                ZIndex: =9

        grpOCEPLName As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =15

            txtOCEPLName As text:
                Color: =RGBA(0, 18, 107, 1)
                Default: =ThisItem.'LAST NAME'
                OnSelect: =Select(Parent)
                Width: =268
                X: =17
                Y: =324
                ZIndex: =2

            Label5_3 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="LAST NAME"
                Width: =320
                X: =17
                Y: =284
                ZIndex: =10

        grpOCEPHireDate As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =15

            DatePicker1 As datepicker:
                DefaultDate: =ThisItem.'HIRE DATE'
                OnSelect: =Select(Parent)
                Width: =268
                X: =17
                Y: =511
                ZIndex: =3

            Label5_4 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="HIRE DATE"
                Width: =320
                X: =17
                Y: =472
                ZIndex: =11

        grpOCEPStatus As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =22

            Label5_9 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="STATUS"
                Width: =320
                X: =17
                Y: =378
                ZIndex: =20

            ComboBox3 As combobox:
                DefaultSelectedItems: =If(!IsBlank(tblSelectedID), ForAll(Filter(colOmniaCreation, ID=tblSelectedID),STATUS))
                DisplayFields: =["Value"]
                Items: =["ACTIVE", "INACTIVE", "LOA", "LOAM", "MATERNITY LEAVE", "PATERNITY LEAVE", "RTWO", "SUSPENDED"]
                OnSelect: =Select(Parent)
                SearchFields: =["Value"]
                SearchItems: =Search(["ACTIVE", "INACTIVE", "LOA", "LOAM", "MATERNITY LEAVE", "PATERNITY LEAVE", "RTWO", "SUSPENDED"],ComboBox3.SearchText,"Value")
                Width: =268
                X: =17
                Y: =418
                ZIndex: =21

        grpOCEPBusUnit As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =22

            ComboBox2 As combobox:
                DefaultSelectedItems: =If(!IsBlank(tblSelectedID), ForAll(Filter(colOmniaCreation, ID=tblSelectedID),'BUSINESS UNIT'))
                DisplayFields: =["Value"]
                IsSearchable: =false
                Items: =Filter(Distinct(Headcount_table, 'BUSINESS UNIT'), !IsBlank(Value))
                OnSelect: =Select(Parent)
                SearchFields: =["Value"]
                SearchItems: =[]
                Width: =323
                X: =323
                Y: =48
                ZIndex: =4

            Label5_5 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="BUSINESS UNIT"
                Width: =323
                X: =323
                Y: =8
                ZIndex: =15

        grpOCEPSubUnit As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =22

            ComboBox2_1 As combobox:
                DefaultSelectedItems: =If(!IsBlank(tblSelectedID), ForAll(Filter(colOmniaCreation, ID=tblSelectedID),'SUB-UNIT'))
                DisplayFields: =["Value"]
                IsSearchable: =false
                Items: =Filter(Distinct(Headcount_table, 'SUB-UNIT'), !IsBlank(Value))
                OnSelect: =Select(Parent)
                SearchFields: =["Value"]
                SearchItems: =[]
                Width: =323
                X: =323
                Y: =139
                ZIndex: =12

            Label5_6 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="SUB-UNIT"
                Width: =323
                X: =323
                Y: =99
                ZIndex: =16

        grpOCEPPosition As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =22

            ComboBox2_2 As combobox:
                DefaultSelectedItems: =If(!IsBlank(tblSelectedID), ForAll(Filter(colOmniaCreation, ID=tblSelectedID),POSITION))
                DisplayFields: =["Value"]
                Items: =Filter(Distinct(Headcount_table, POSITION), !IsBlank(Value))
                OnSelect: =Select(Parent)
                SearchFields: =["Value"]
                SearchItems: =Search(Filter(Distinct(Headcount_table, POSITION), !IsBlank(Value)),ComboBox2_2.SearchText,"Value")
                Width: =323
                X: =323
                Y: =231
                ZIndex: =13

            Label5_7 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="POSITION"
                Width: =323
                X: =323
                Y: =193
                ZIndex: =17

        grpOCEPEmpStatus As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =22

            ComboBox2_3 As combobox:
                DefaultSelectedItems: =If(!IsBlank(tblSelectedID), ForAll(Filter(colOmniaCreation, ID=tblSelectedID),'EMPLOYMENT STATUS'))
                DisplayFields: =["Value"]
                IsSearchable: =false
                Items: =Filter(Distinct(Headcount_table, 'EMPLOYMENT STATUS'), !IsBlank(Value))
                OnSelect: =Select(Parent)
                SearchFields: =["Value"]
                SearchItems: =[]
                Width: =323
                X: =323
                Y: =324
                ZIndex: =14

            Label5_8 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="EMPLOYMENT STATUS"
                Width: =323
                X: =323
                Y: =284
                ZIndex: =18

        grpOCEPClient As group:
            Height: =5
            Width: =5
            X: =-297
            Y: =25
            ZIndex: =30

            ComboBox2_4 As combobox:
                DefaultSelectedItems: =If(!IsBlank(tblSelectedID), ForAll(Filter(colOmniaCreation, ID=tblSelectedID),CLIENT))
                DisplayFields: =["Value"]
                IsSearchable: =false
                Items: =Filter(Distinct(Headcount_table, CLIENT), !IsBlank(Value))
                OnSelect: =Select(Parent)
                SearchFields: =["Value"]
                SearchItems: =[]
                Width: =323
                X: =681
                Y: =48
                ZIndex: =22

            Label5_10 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="CLIENT"
                Width: =323
                X: =681
                Y: =8
                ZIndex: =26

        grpOCEPCampaign As group:
            Height: =5
            Width: =5
            X: =-297
            Y: =25
            ZIndex: =31

            ComboBox2_5 As combobox:
                DefaultSelectedItems: =If(!IsBlank(tblSelectedID), ForAll(Filter(colOmniaCreation, ID=tblSelectedID),CAMPAIGN))
                DisplayFields: =["Value"]
                IsSearchable: =false
                Items: =Filter(Distinct(Headcount_table, CAMPAIGN), !IsBlank(Value))
                OnSelect: =Select(Parent)
                SearchFields: =["Value"]
                SearchItems: =[]
                Width: =323
                X: =681
                Y: =139
                ZIndex: =23

            Label5_11 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="CAMPAIGN"
                Width: =323
                X: =681
                Y: =99
                ZIndex: =27

        grpOCEPLOB As group:
            Height: =5
            Width: =5
            X: =-297
            Y: =25
            ZIndex: =32

            ComboBox2_6 As combobox:
                DefaultSelectedItems: =If(!IsBlank(tblSelectedID), ForAll(Filter(colOmniaCreation, ID=tblSelectedID),LOB))
                DisplayFields: =["Value"]
                Items: =Filter(Distinct(Headcount_table, LOB), !IsBlank(Value))
                OnSelect: =Select(Parent)
                SearchFields: =["Value"]
                SearchItems: =Search(Filter(Distinct(Headcount_table, LOB), !IsBlank(Value)),ComboBox2_6.SearchText,"Value")
                Width: =323
                X: =681
                Y: =231
                ZIndex: =24

            Label5_12 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="LOB"
                Width: =323
                X: =681
                Y: =193
                ZIndex: =28

        grpOCEPSubLOB As group:
            Height: =5
            Width: =5
            X: =-297
            Y: =25
            ZIndex: =33

            ComboBox2_7 As combobox:
                DefaultSelectedItems: =If(!IsBlank(tblSelectedID), ForAll(Filter(colOmniaCreation, ID=tblSelectedID),'SUB-LOB'))
                DisplayFields: =["Value"]
                IsSearchable: =false
                Items: =Filter(Distinct(Headcount_table, 'SUB-LOB'), !IsBlank(Value))
                OnSelect: =Select(Parent)
                SearchFields: =["Value"]
                SearchItems: =[]
                Width: =323
                X: =681
                Y: =324
                ZIndex: =25

            Label5_13 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="SUB-LOB"
                Width: =323
                X: =681
                Y: =284
                ZIndex: =29

        grpOCEPSupervisor As group:
            Height: =5
            Width: =5
            X: =-636
            Y: =25
            ZIndex: =38

            ComboBox2_8 As combobox:
                DefaultSelectedItems: =If(!IsBlank(tblSelectedID), ForAll(Filter(colOmniaCreation, ID=tblSelectedID),SUPERVISOR))
                DisplayFields: =["Value"]
                IsSearchable: =false
                Items: =Filter(Distinct(Headcount_table, TEAM), !IsBlank(Value))
                OnSelect: =Select(Parent)
                SearchFields: =["Value"]
                SearchItems: =[]
                Width: =323
                X: =1040
                Y: =48
                ZIndex: =30

            Label5_14 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="SUPERVISOR"
                Width: =323
                X: =1040
                Y: =8
                ZIndex: =34

        grpOCECountry As group:
            Height: =5
            Width: =5
            X: =-636
            Y: =25
            ZIndex: =39

            ComboBox2_9 As combobox:
                DefaultSelectedItems: =If(!IsBlank(tblSelectedID), ForAll(Filter(colOmniaCreation, ID=tblSelectedID),COUNTRY))
                DisplayFields: =["Value"]
                IsSearchable: =false
                Items: =Filter(Distinct(Headcount_table, COUNTRY), !IsBlank(Value))
                OnSelect: =Select(Parent)
                SearchFields: =["Value"]
                SearchItems: =[]
                Width: =323
                X: =1040
                Y: =139
                ZIndex: =31

            Label5_15 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="COUNTRY"
                Width: =323
                X: =1040
                Y: =99
                ZIndex: =35

        grpOCEPSite As group:
            Height: =5
            Width: =5
            X: =-636
            Y: =25
            ZIndex: =40

            cbOCEPSite As combobox:
                DefaultSelectedItems: =If(!IsBlank(tblSelectedID), ForAll(Filter(colOmniaCreation, ID=tblSelectedID),SITE))
                DisplayFields: =["Value"]
                Items: =Filter(Distinct(Headcount_table, SITE), !IsBlank(Value))
                OnSelect: =Select(Parent)
                SearchFields: =["Value"]
                SearchItems: =Search(Filter(Distinct(Headcount_table, SITE), !IsBlank(Value)),cbOCEPSite.SearchText,"Value")
                Width: =323
                X: =1040
                Y: =231
                ZIndex: =32

            Label5_16 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="SITE"
                Width: =323
                X: =1040
                Y: =193
                ZIndex: =36

        grpOCEPBillability As group:
            Height: =5
            Width: =5
            X: =-641
            Y: =-251
            ZIndex: =40

            cbOCEPBillability As combobox:
                DefaultSelectedItems: =If(!IsBlank(tblSelectedID), ForAll(Filter(colOmniaCreation, ID=tblSelectedID),BILLABILITY))
                DisplayFields: =["Value"]
                IsSearchable: =false
                Items: =Filter(Distinct(Headcount_table, BILLABILITY), !IsBlank(Value))
                OnSelect: =Select(Parent)
                SearchFields: =["Value"]
                SearchItems: =[]
                Width: =323
                X: =681
                Y: =418
                ZIndex: =38

            Label5_18 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="BILLABILITY"
                Width: =323
                X: =681
                Y: =378
                ZIndex: =39

        grpOCEPEmpId As group:
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =41

            Label5 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="EMPLOYEE ID"
                Width: =320
                X: =17
                Y: =8
                ZIndex: =7

            txtOCEPEmpId As label:
                OnSelect: =Select(Parent)
                Text: =ThisItem.ID
                Width: =268
                X: =17
                Y: =48
                ZIndex: =40

        grpOCEPRole As group:
            Height: =5
            Width: =5
            X: =-636
            Y: =25
            ZIndex: =41

            cbOCEPRole As combobox:
                DefaultSelectedItems: =If(!IsBlank(tblSelectedID), ForAll(Filter(colOmniaCreation, ID=tblSelectedID),ROLE))
                DisplayFields: =["Value"]
                IsSearchable: =false
                Items: =Filter(Distinct(Headcount_table, ROLE), !IsBlank(Value))
                OnSelect: =Select(Parent)
                SearchFields: =["Value"]
                SearchItems: =[]
                Width: =323
                X: =1040
                Y: =324
                ZIndex: =33

            Label5_17 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: =Select(Parent)
                Text: ="ROLE"
                Width: =323
                X: =1040
                Y: =284
                ZIndex: =37

    grpOCEPButtons As group:
        Height: =5
        Width: =5
        X: =-1010
        Y: =-664
        ZIndex: =10

        btnOCEPBack As button:
            Color: =RGBA(0, 18, 107, 1)
            Fill: =RGBA(186, 202, 226, 1)
            OnSelect: =Navigate(OmniaCreation_SecondPage,ScreenTransition.Cover)
            Text: ="Back"
            X: =1030
            Y: =684
            ZIndex: =8

        btnOCEPUpdate As button:
            Fill: =RGBA(0, 18, 107, 1)
            OnSelect: |-
                =If(
                    (!IsBlank(txtOCFPEmpId.Text) &&
                        !IsBlank(txtOCFPFName.Text) &&
                        !IsBlank(txtOCFPMName.Text) &&
                        !IsBlank(txtOCFPLName.Text) &&
                        !IsBlank(dateOCFPHireDate.SelectedDate) &&
                        (!IsBlank(cbOCFPBusUnit.Selected.Value) || !IsBlank(cbOCFPBusUnit.SearchText)) &&
                        (!IsBlank(cbOCFPSubUnit.Selected.Value) || !IsBlank(cbOCFPSubUnit.SearchText)) &&
                        (!IsBlank(cbOCFPPosition.Selected.Value) || !IsBlank(cbOCFPPosition.SearchText)) &&
                        (!IsBlank(cbOCFPClient.Selected.Value) || !IsBlank(cbOCFPClient.SearchText)) &&
                        (!IsBlank(cbOCFPCampaign.Selected.Value) || !IsBlank(cbOCFPCampaign.SearchText)) &&
                        (!IsBlank(cbOCFPSubLOB.Selected.Value) || !IsBlank(cbOCFPSubLOB.SearchText)) &&
                        (!IsBlank(cbOCFPLOB.Selected.Value) || !IsBlank(cbOCFPLOB.SearchText)) &&
                        (!IsBlank(cbOCFPBillability.Selected.Value) || !IsBlank(cbOCFPBillability.SearchText)) &&
                        (!IsBlank(cbOCFPSupervisor.Selected.Value) || !IsBlank(cbOCFPSupervisor.SearchText)) &&
                        (!IsBlank(cbOCFPCountry.Selected.Value) || !IsBlank(cbOCFPCountry.SearchText)) &&
                        (!IsBlank(cbOCFPSite.Selected.Value) || !IsBlank(cbOCFPSite.SearchText)) &&
                        (!IsBlank(cbOCFPRole.Selected.Value) || !IsBlank(cbOCFPRole.SearchText)) 
                    ),
                    If(
                        CountRows(
                            Filter(colOmniaCreation,'EMPLOYEE ID'=txtOCFPEmpId.Text)
                        ) > 0, 
                        Remove(colOmniaCreation, LookUp(colOmniaCreation, 'EMPLOYEE ID'=txtOCFPEmpId.Text)
                    ));
                    Collect(colOmniaCreation, {
                            'EMPLOYEE ID':txtOCFPEmpId.Text,
                            ID:txtOCFPEmpId.Text,
                            'FIRST NAME':txtOCFPFName.Text,
                            'MIDDLE NAME':txtOCFPMName.Text,
                            'LAST NAME':txtOCFPLName.Text,
                            'HIRE DATE':dateOCFPHireDate.SelectedDate,
                            STATUS:"ACTIVE",
                            'REGULARIZATION DATE':Text(DateAdd(dateOCFPHireDate.SelectedDate, 6, TimeUnit.Months),"yyyy-mm-dd"),
                            'BUSINESS UNIT':If(IsBlank(cbOCFPBusUnit.Selected.Value), cbOCFPBusUnit.SearchText, cbOCFPBusUnit.Selected.Value), 
                            'SUB-UNIT':If(IsBlank(cbOCFPSubUnit.Selected.Value), cbOCFPSubUnit.SearchText, cbOCFPSubUnit.Selected.Value),
                            'SUB UNIT':If(IsBlank(cbOCFPSubUnit.Selected.Value), cbOCFPSubUnit.SearchText, cbOCFPSubUnit.Selected.Value),
                            POSITION:If(IsBlank(cbOCFPPosition.Selected.Value), cbOCFPPosition.SearchText, cbOCFPPosition.Selected.Value), 
                            'EMPLOYMENT STATUS':"Probationary",
                            CLIENT:If(IsBlank(cbOCFPClient.Selected.Value), cbOCFPClient.SearchText, cbOCFPClient.Selected.Value),
                            CAMPAIGN:If(IsBlank(cbOCFPCampaign.Selected.Value), cbOCFPCampaign.SearchText, cbOCFPCampaign.Selected.Value),
                            'SUB-LOB':If(IsBlank(cbOCFPSubLOB.Selected.Value), cbOCFPSubLOB.SearchText, cbOCFPSubLOB.Selected.Value),
                            LOB:If(IsBlank(cbOCFPLOB.Selected.Value), cbOCFPLOB.SearchText, cbOCFPLOB.Selected.Value),
                            BILLABILITY:If(IsBlank(cbOCFPBillability.Selected.Value), cbOCFPBillability.SearchText, cbOCFPBillability.Selected.Value),
                            SUPERVISOR:If(IsBlank(cbOCFPSupervisor.Selected.Value), cbOCFPSupervisor.SearchText, cbOCFPSupervisor.Selected.Value),
                            COUNTRY:If(IsBlank(cbOCFPCountry.Selected.Value), cbOCFPCountry.SearchText, cbOCFPCountry.Selected.Value),
                            SITE:If(IsBlank(cbOCFPSite.Selected.Value), cbOCFPSite.SearchText, cbOCFPSite.Selected.Value), 
                            ROLE:If(IsBlank(cbOCFPRole.Selected.Value), cbOCFPRole.SearchText, cbOCFPRole.Selected.Value),
                            'SUBMITTED BY':User().Email
                        }
                    );
                    Notify("Successfully saved your changes locally.", NotificationType.Success) &&
                    Navigate(OmniaCreation_SecondPage),
                    Notify("Please fill out all fields!", NotificationType.Error)
                )
            Text: ="Update"
            X: =1222
            Y: =684
            ZIndex: =9

